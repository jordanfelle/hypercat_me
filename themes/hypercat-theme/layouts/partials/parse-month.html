{{- /* Parse month string to YYYY-MM format */}}
{{- /* Input: . (context with .monthStr and .now) */}}
{{- /* Returns: string in YYYY-MM format */}}

{{- $monthStr := .monthStr }}
{{- $now := .now }}
{{- $result := $monthStr }}

{{- /* If already in YYYY-MM format, return as is */}}
{{- if and (in $monthStr "-") (not (strings.Contains $monthStr " ")) }}
    {{- $result = $monthStr }}
{{- else }}
    {{- /* Handle "Month YYYY" format */}}
    {{- if (strings.Contains $monthStr " ") }}
        {{- $parts := split $monthStr " " }}
        {{- $monthName := index $parts 0 }}
        {{- $year := index $parts 1 }}
        {{- $monthNames := slice "January" "February" "March" "April" "May" "June" "July" "August" "September" "October" "November" "December" }}
        {{- $monthNum := 0 }}
        {{- range $idx, $m := $monthNames }}
            {{- if eq $monthName $m }}
                {{- $monthNum = add $idx 1 }}
            {{- end }}
        {{- end }}
        {{- $result = printf "%s-%02d" $year $monthNum }}
    {{- else if (not (in $monthStr "-")) }}
        {{- /* Just month name, assume current year */}}
        {{- $monthNames := slice "January" "February" "March" "April" "May" "June" "July" "August" "September" "October" "November" "December" }}
        {{- $monthNum := 0 }}
        {{- range $idx, $m := $monthNames }}
            {{- if eq $monthStr $m }}
                {{- $monthNum = add $idx 1 }}
            {{- end }}
        {{- end }}
        {{- $result = printf "%d-%02d" $now.Year $monthNum }}
    {{- end }}
{{- end }}

{{- return $result }}
